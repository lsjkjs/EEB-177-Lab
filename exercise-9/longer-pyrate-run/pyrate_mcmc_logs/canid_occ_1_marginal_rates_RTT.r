# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.174921152304, 0.174921152304,0.174921152304,0.174921152304,0.0895261971084,0.0792919820609,0.0397062419388,0.0453019239014,0.0416452745425,0.0432991714311,0.0439217804514,0.0451306558055,0.0452524443374,0.0446195378773,0.0452524443374,0.0468300530579,0.0532217864801,0.0693980996144,0.0712236663772,0.0788414653957,0.0804924006965,0.0808719348699,0.0803977126607,0.0808719348699,0.0803977126607,0.0803977126607,0.0798127498475,0.0795261588926,0.0799698074346,0.0788414653957,0.0858942875932,0.121735089455,0.153362415515,0.155257938428,0.153362415515,0.147857840046,0.148949946621,0.150637680822,0.147003605921,0.142257745791,0.140199693676,0.132787241297,0.120564038709,0.118798122377,0.100617979515,0.0830444034142,0.0557777493361,0.0551824085294,0.0551824085294,0.0469679294215,0.0469679294215)
L_hpd_M95=c(0.360677903756, 0.360677903756,0.360677903756,0.360961424926,0.323921427708,0.323532562152,0.244075024077,0.13133920592,0.126153010988,0.126819735254,0.126819735254,0.126819735254,0.126819735254,0.126944622411,0.127782170929,0.136086938299,0.14737009472,0.156545680399,0.156294258691,0.159456658769,0.159102507492,0.159102507492,0.159102507492,0.159965733253,0.159750342344,0.159750342344,0.159965733253,0.159965733253,0.161962611854,0.290852719149,0.413109866949,0.441917260108,0.460680647439,0.459149211942,0.453822651707,0.44237590699,0.441917260108,0.441917260108,0.44237590699,0.44237590699,0.441465390906,0.439847258481,0.44211919612,0.458179071457,0.473268899029,0.487856482707,0.486873930202,0.510987851199,0.534979607511,0.528102069111,0.528102069111)
M_hpd_m95=c(0.862949650889, 0.862949650889,0.0888018873552,0.0888018873552,0.0890332493369,0.0895580529365,0.0905057036483,0.0890332493369,0.0900287152033,0.0906173567545,0.0916146411006,0.0918000964475,0.0914039826071,0.0911867671693,0.0911867671693,0.0910226483553,0.0900287152033,0.0900287152033,0.0900287152033,0.0900686308231,0.0891221671947,0.0882873422272,0.0794785978498,0.0670323122279,0.0605889458833,0.0462943062062,0.0385005102751,0.0328151280954,0.0328765819219,0.0320823265033,0.0328765819219,0.0328952765824,0.0328765819219,0.0309102683238,0.030086946794,0.0281162243387,0.0279087600636,0.0304039728021,0.0278586696675,0.0279087600636,0.0253854137501,0.0248661180835,0.0241467405643,0.0253854137501,0.0248661180835,0.0248661180835,0.0248661180835,0.0248661180835,0.0248661180835,0.0248661180835,0.0248661180835)
M_hpd_M95=c(1.5045528225, 1.5045528225,0.145830569908,0.145830569908,0.145339865813,0.145339865813,0.144621601835,0.140760759768,0.139334443385,0.139318436955,0.138842944885,0.138842944885,0.138768392335,0.138659892578,0.138659892578,0.138659892578,0.138563504151,0.138563504151,0.138768392335,0.139334443385,0.138563504151,0.139334443385,0.139334443385,0.138551648957,0.136958002782,0.133807203243,0.128542698195,0.11708431149,0.113567650646,0.109328749597,0.109291773194,0.109232098604,0.109328749597,0.109423711552,0.110817033849,0.110817033849,0.110817033849,0.117286032322,0.120244321876,0.132460880302,0.13836743535,0.145243813029,0.145901999222,0.149522238683,0.150235944952,0.150235944952,0.150235944952,0.150235944952,0.150235944952,0.150235944952,0.150235944952)
R_hpd_m95=c(-1.23103995496, -1.23103995496,0.0501207132683,0.0491347503248,-0.0182755724895,-0.043648622178,-0.085155965994,-0.0819628556587,-0.0805455155889,-0.0797653339612,-0.0768039563428,-0.076631493486,-0.076631493486,-0.0765916112532,-0.0761625977812,-0.0743756185896,-0.0655151464103,-0.0499752897899,-0.0476424558635,-0.0473147558934,-0.0471608766631,-0.0416556734432,-0.0425372332041,-0.0413548739493,-0.0413548739493,-0.0397318941596,-0.030466257152,-0.0200191647824,-0.0197315117748,-0.0240415491574,0.00288191830248,0.0652851327267,0.0853601448084,0.102762676374,0.106268880893,0.0925631373397,0.0853601448084,0.0855543665986,0.0783789508686,0.0672107036537,0.0672107036537,0.0491435840632,0.0474147639968,0.0321560876545,0.0067030680841,0.00246483405238,-0.0258153260618,-0.0355366903523,-0.0258153260618,-0.0258153260618,-0.0258153260618)
R_hpd_M95=c(-0.562162486245, -0.562162486245,0.24756436217,0.24756436217,0.219997152463,0.206957234208,0.144875083579,0.0248164804518,0.0232892307439,0.0232892307439,0.0232892307439,0.023170221379,0.0229810240483,0.023170221379,0.0232892307439,0.0286098705944,0.0420549849369,0.0494204940845,0.0502664947845,0.0517472492217,0.0513005287112,0.0571460019412,0.0615772437312,0.0657002652168,0.0686367519645,0.082837619914,0.0988319704678,0.104404013571,0.10365418685,0.224825251868,0.354727040351,0.395548860264,0.395548860264,0.410255297373,0.408824508845,0.395366911862,0.388783677153,0.389811330203,0.390751588422,0.389811330203,0.391477721078,0.387846547583,0.396745555406,0.401033309769,0.412069975914,0.433649274888,0.444443670975,0.473752506043,0.522366051492,0.522366051492,0.522366051492)
L_mean=c(0.258842995962, 0.258842995962,0.258842995962,0.258788749208,0.246481994628,0.218768970197,0.106010233938,0.09177896467,0.0913139830044,0.0911403768186,0.0910180082518,0.0910930750888,0.0911738434827,0.091351732001,0.0917401622105,0.0960864777181,0.10414521049,0.109262611463,0.111137512619,0.113373600686,0.114594645424,0.114848621127,0.115010181029,0.115045636212,0.115095675259,0.115080899523,0.115027787651,0.115082971219,0.115527989037,0.132096559814,0.260513318158,0.320759439512,0.324758704558,0.3255502279,0.325761568577,0.323104077808,0.320403625205,0.31927320586,0.318361152127,0.316691625836,0.314811823613,0.314777625043,0.313895097376,0.312461887838,0.307379290937,0.303414282153,0.302568469387,0.302408019329,0.30382250677,0.303133080622,0.303139165638)
M_mean=c(1.15576044253, 1.15576044253,0.119043184238,0.119043144557,0.119005877987,0.118819686314,0.118224206352,0.1171242022,0.116376596246,0.11614277358,0.115704586758,0.115602537517,0.115263666391,0.115075892479,0.114813783186,0.114718845345,0.114414496726,0.114265717469,0.114327332294,0.114434471005,0.114469754858,0.114266326591,0.1124382007,0.110033679249,0.107187494539,0.0961227898521,0.0804176790649,0.0719953939897,0.0696789765393,0.0682978042934,0.067810581629,0.0676824586524,0.0676965570691,0.068103690796,0.0686213200226,0.0688038308875,0.0686948095676,0.0690583470332,0.0704043059197,0.0725372850133,0.0742069368487,0.0756347448492,0.0759716953708,0.0763174769656,0.0765862473019,0.0766151140253,0.0766151140253,0.0766151140253,0.0766151140253,0.0766151140253,0.0766151140253)
R_mean=c(-0.896917446569, -0.896917446569,0.139799811724,0.139745604651,0.127476116641,0.0999492838834,-0.012213972414,-0.0253452375303,-0.0250626132416,-0.0250023967615,-0.0246865785063,-0.0245094624285,-0.024089822908,-0.0237241604782,-0.0230736209756,-0.018632367627,-0.0102692862353,-0.00500310600616,-0.00318981967448,-0.00106087031887,0.000124890565693,0.00058229453624,0.0025719803292,0.00501195696269,0.00790818071991,0.018958109671,0.034610108586,0.0430875772293,0.0458490124976,0.0637987555209,0.192702736529,0.25307698086,0.257062147489,0.257446537104,0.257140248554,0.25430024692,0.251708815637,0.250214858826,0.247956846207,0.244154340823,0.240604886765,0.239142880194,0.237923402005,0.236144410872,0.230793043635,0.226799168128,0.225953355362,0.225792905304,0.227207392745,0.226517966596,0.226524051612)
trans=0.5
age=(0:(51-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.588477568262), xlim = c(-53.55,2.55), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.65500810475), xlim = c(-53.55,2.55), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.35414395045, 0.574602656642), xlim = c(-53.55,2.55), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-53.55,2.55), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()